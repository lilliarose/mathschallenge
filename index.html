<!DOCTYPE HTML>
<html lang = 'en'>
    <head>
        <title>Maths Challenge</title>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
        <link rel="stylesheet" href="style.css">
        <meta name="viewport" content="width=device-width">

        <script>
            //does this as soon as the window loads
            window.onload = (event) => {
                    addClickListeners();
                    let buttonMarkIt = document.getElementById("markIt");
                    buttonMarkIt.disabled = true;
                    let buttonGo = document.getElementById("goButton");
                    buttonGo.disabled = true;
            }
            
            //define variables with script-wide scope
            let realAnswers
            let timerStart
            let correctAnswers
            let red = "#d10e00";
            let green = "#43b516";
            const question_id = ['q1','q2','q3','q4','q5','q6','q7','q8','q9','q10']
            const userAnswer_id = ['inputAnswer1','inputAnswer2','inputAnswer3','inputAnswer4','inputAnswer5','inputAnswer6','inputAnswer7','inputAnswer8','inputAnswer9','inputAnswer10']
            const mark_id = ['mark1','mark2','mark3','mark4','mark5','mark6','mark7','mark8','mark9','mark10']
            let currentLevel = 'bronze'; // the level (bronze, silver, gold, platinum) currently selected

            // Bronze Award stages
            let levelBronzeID = [101,102,103,104,105,106,107,108,109,110,
                                111,112,113,114,115,116,117,118,119,120,
                                121,122,123,124,125,126,127,128,129,130,131];

            let levelBronzeText = ['1.    10s in order',
                                    '2.    10s mixed',
                                    '3.    10s division mixed',
                                    '4.    5s in order',
                                    '5.    5s mixed',
                                    '6.    5s division mixed',
                                    '7.    10s and 5s mixed',
                                    '8.    2s in order',
                                    '9.    2s mixed',
                                    '10.  2s divison mixed',
                                    '11.  4s in order',
                                    '12.  4s mixed',
                                    '13.  4s division mixed',
                                    '14.  8s in order',
                                    '15.  8s mixed',
                                    '16.  8s division mixed',
                                    '17.  2, 4, 8s mixed ',
                                    '18.  3s in order',
                                    '19.  3s mixed',
                                    '20.  3s division',
                                    '21.  6s in order',
                                    '22.  6s mixed',
                                    '23.  6s division mixed',
                                    '24.  9s in order',
                                    '25.  9s mixed',
                                    '26.  9s division mixed',
                                    '27.  3, 6, 9s mixed',
                                    '28.  7s in order',
                                    '29.  7s mixed',
                                    '30.  7s division mixed',
                                    '31.  2s - 10s mixed'];

            // Silver Award Stages
            let levelSilverID = [201,202,203,204,205,206,207,208,209,210,
                                211,212,213,214,215,216,217,218,219,220,
                                221,222,223,224,225,226,227,228,229,230];
                                
            let levelSilverText = ['1. 11s in order',
                                    '2. 11s mixed',
                                    '3. 11s division mixed',
                                    '4. 12s in order',
                                    '5. 12s mixed',
                                    '6. 12s division mixed',
                                    '7. 11s and 12s mixed (\u00D7 & \u00F7)',
                                    '8. Square numbers',
                                    '9.  Square roots',
                                    '10. All tables mixed \u00D7',
                                    '11. All tables mixed \u00F7',
                                    '12. All tables mixed (\u00D7 & \u00F7)',
                                    '13. U \u00D7 50',
                                    '14. Multiples of 50 \u00F7 50',
                                    '15. U \u00D7 20',
                                    '16. Multiples of 20 \u00F7 20',
                                    '17. U \u00D7 40',
                                    '18. Multiples of 40 \u00F7 40',
                                    '19. U \u00D7 80',
                                    '20. Multiples of 80 \u00F7 80',
                                    '21. U \u00D7 30',
                                    '22. Multiples of 30 \u00F7 30',
                                    '23. U \u00D7 60',
                                    '24. Multiples of 60 \u00F7 60',
                                    '25. U \u00D7 90',
                                    '26. Multiples of 90 \u00F7 90',
                                    '27. U \u00D7 70',
                                    '28. Multiples of 70 \u00F7 70',
                                    '29. 2 & 3 digit \u00D7 10 & 100',
                                    '30. 2 & 3 digit \u00F7 10 & 100'];

            // Gold Award Stages
            let levelGoldID = [301,302,303,304,305,306,307,308,309,310,
                                311,312,313,314,315,316,317,318,319,320,
                                321,322,323,324,325,326,327,328,329,330];

            let levelGoldText = ['1. Factors',
                                '2. Double integers up to 100',
                                '3. \u00BD evens up to 100',
                                '4. \u00BD odds up to 50',
                                '5. Double integers up to 200',
                                '6. Double integers up to 500',
                                '7. Unit fractions of amounts',
                                '8. Fractions of amounts',
                                '9. Double decimals \u003C 1 with 2dp',
                                '10. \u00BD decimals \u003C 10 containing 10ths ',
                                '11. Double decimals \u003C 25 with 2dp',
                                '12. Double  multiples of 10 (\u003C1000)',
                                '13. \u00BD multiples of 10 (\u003C1000)',
                                '14. Double multiples of 10 (\u003C10,000)',
                                '15. \u00BD multiples of 10 (\u003C10,000)',
                                '16. Multiples of 10 squared',
                                '17. 2 digit \u00D7 4',
                                '18. 2 digit \u00F7 4',
                                '19. 15 times tables (\u00D7 and \u00F7)',
                                '20. 16 times tables (\u00D7 and \u00F7)',
                                '21. 18 times tables (\u00D7 and \u00F7)',
                                '22. 14 times tables (\u00D7 and \u00F7)',
                                '23. 13 times tables (\u00D7 and \u00F7)',
                                '24. 19 times tables (\u00D7 and \u00F7)',
                                '25. 17 times tables (\u00D7 and \u00F7)',
                                '26. 2 digit multiply by 4, 6, 8',
                                '27. 2 digit multiply by 3, 7, 9',
                                '28. 2 digit number \u003C 50 \u00D7 U',
                                '29. Decimal \u003C 5 (1dp) \u00D7 U',
                                '30. Decimal \u003C 10 (1dp) \u00D7 U'];

            // Platinum Award Stages
            let levelPlatinumID = [401,402,403,404,405,406,407,408,409,410,
                                411,412,413,414,415,416,417,418,419,420,
                                421,422,423,424,425,426,427,428,429,430];
            
            let levelPlatinumText = ['1. TU \u00D7 25',
                                    '2. TU \u00D7 50',
                                    '3. TU \u00D7 20',
                                    '4. TU \u00D7 40',
                                    '5. TU \u00D7 80',
                                    '6. TU \u00D7 30',
                                    '7. TU \u00D7 60',
                                    '8. TU \u00D7 90',
                                    '9. TU \u00D7 70',
                                    '10. Doubling 5 dig. to 2 d.p. < 200',
                                    '11. Halving 3 dig. odd nos. < 200',
                                    '12. Halving 3 dig. odd nos. > 200',
                                    '13. 5/ 6 dig. nos. to 2 d.p. \u00D7 U',
                                    '14. Halving 5 dig. to 2 d.p. < 200',
                                    '15. 6 dig. nos. to 3 d.p.\u00D7 U',
                                    '16. Halving 5 dig.nos. to 1 d.p.',
                                    '17. Doubling 5 dig. to 2 d.p. > 200',
                                    '18. Halving 5 dig. to 2 d.p. > 200',
                                    '19. 3 dig. nos. \u00F7 4',
                                    '20. 4 dig. nos.  to 1 d.p. \u00F7 4',
                                    '21. 4 dig. nos. < 10000 \u00F7 U',
                                    '22. HTU \u00D7 TU ',
                                    '23. 5 dig. to 2 d.p. \u00D7 3',
                                    '24. 4/5 dig. nos. to 1 d.p. \u00F7 3',
                                    '25. Factorials',
                                    '26. mod (remainder after division)',
                                    '27. 3 dig. nos. squared',
                                    '28. 2 dig. nos. cubed',
                                    '29. Cube roots (\u221B)',
                                    '30. Percentge of decimals'];

             //called when window loads
            function addClickListeners() {
                //go button click listener
                let button = document.getElementById("goButton");
                button.addEventListener("click", callback_goButton);
                let markIt = document.getElementById("markIt");
                markIt.addEventListener("click", callback_markIt);
                let buttonBronze = document.getElementById("buttonBronze");
                buttonBronze.addEventListener("click", callback_buttonBronze);
                let buttonSilver = document.getElementById("buttonSilver");
                buttonSilver.addEventListener("click", callback_buttonSilver);
                let buttonGold = document.getElementById("buttonGold");
                buttonGold.addEventListener("click", callback_buttonGold);
                let buttonPlatinum = document.getElementById("buttonPlatinum");
                buttonPlatinum.addEventListener("click", callback_buttonPlatinum);
                //markIt.disabled = true;

                // TODO: Add buttons for  bronze, silver, gold, platinum stages
                // see https://dev.to/nicm42/multiple-buttons-looking-like-theyre-staying-pressed-one-at-a-time-4bbb
                // Bronze #CD7F32
                // Silver #C0C0C0
                // Gold #D4AF37
                // Platinum  #E5E4E2
                
                // TODO: Add listener function for bronze, silver, gold, platinum buttons

                
                // TODO: populate dropdown list with appropriate strings of stage types on cliking of button
                
                // TODO: code the getQuestions function for each stage added
            }

            function callback_buttonBronze () {
                if (getCurrentLevel() == 'bronze') {
                    //return
                }
                
                let numStages = getCurrentStagesPerLevel();
                let stagesDropDown = document.getElementById("dropdown-menu");
                //Now remove the menu items one at a time until only the 'select stage' item remains
                for (let i = 0; i < numStages; i++) {
                    stagesDropDown.remove(1); // remove the menu item just after the 'select stage' text item
                }

                // From https://softauthor.com/javascript-dynamic-html-select-drop-down/
                let listLength = levelBronzeID.length
                // Fill up the dropdown with the value and text for each stage of the bronze level
                for (let i = 0; i < listLength; i++) {
                    let option = document.createElement("option");
                    option.setAttribute('value', levelBronzeID[i]);
                    let optionText = document.createTextNode(levelBronzeText[i]);
                    option.appendChild(optionText);
                    stagesDropDown.appendChild(option);   
                }
                
                currentLevel = 'bronze';
            }

            function callback_buttonSilver () {
                if (getCurrentLevel() == 'silver') {
                    //return
                }
                
                let numStages = getCurrentStagesPerLevel();
                let stagesDropDown = document.getElementById("dropdown-menu");
                //Now remove the menu items one at a time until only the 'select stage' item remains
                for (let i = 0; i < numStages; i++) {
                    stagesDropDown.remove(1); // remove the menu item just after the 'select stage' text item
                }

                // From https://softauthor.com/javascript-dynamic-html-select-drop-down/
                let listLength = levelSilverID.length
                // Fill up the dropdown with the value and text for each stage of the bronze level
                for (let i = 0; i < listLength; i++) {
                    let option = document.createElement("option");
                    option.setAttribute('value', levelSilverID[i]);
                    let optionText = document.createTextNode(levelSilverText[i]);
                    option.appendChild(optionText);
                    stagesDropDown.appendChild(option);   
                }
                
                currentLevel = 'silver';

            }

            function callback_buttonGold () {
                if (getCurrentLevel() == 'gold') {
                    //return
                }
                
                let numStages = getCurrentStagesPerLevel();
                let stagesDropDown = document.getElementById("dropdown-menu");
                //Now remove the menu items one at a time until only the 'select stage' item remains
                for (let i = 0; i < numStages; i++) {
                    stagesDropDown.remove(1); // remove the menu item just after the 'select stage' text item
                }

                // From https://softauthor.com/javascript-dynamic-html-select-drop-down/
                let listLength = levelGoldID.length
                // Fill up the dropdown with the value and text for each stage of the bronze level
                for (let i = 0; i < listLength; i++) {
                    let option = document.createElement("option");
                    option.setAttribute('value', levelGoldID[i]);
                    let optionText = document.createTextNode(levelGoldText[i]);
                    option.appendChild(optionText);
                    stagesDropDown.appendChild(option);   
                }
                
                currentLevel = 'gold';

            }

            function callback_buttonPlatinum () {
                if (getCurrentLevel() == 'platinum') {
                    //return
                }
                
                let numStages = getCurrentStagesPerLevel();
                let stagesDropDown = document.getElementById("dropdown-menu");
                //Now remove the menu items one at a time until only the 'select stage' item remains
                for (let i = 0; i < numStages; i++) {
                    stagesDropDown.remove(1); // remove the menu item just after the 'select stage' text item
                }

                // From https://softauthor.com/javascript-dynamic-html-select-drop-down/
                let listLength = levelPlatinumID.length
                // Fill up the dropdown with the value and text for each stage of the bronze level
                for (let i = 0; i < listLength; i++) {
                    let option = document.createElement("option");
                    option.setAttribute('value', levelPlatinumID[i]);
                    let optionText = document.createTextNode(levelPlatinumText[i]);
                    option.appendChild(optionText);
                    stagesDropDown.appendChild(option);   
                }

                currentLevel = 'platinum';
            }

            //called when dropdown list is changed
            function callback_changeStage() {  

                // Clear any previous questions, user answers and marks from the screen
                for (let i = 0; i < 10; i++) {
                    document.getElementById(question_id[i]).innerHTML  = "";
                    document.getElementById(userAnswer_id[i]).value = "";
                    document.getElementById(mark_id[i]).style.backgroundColor = "#cccccc";
                }

                if (getCurrentStage() == "unselected") {
                    let buttonMarkIt = document.getElementById("markIt");
                    buttonMarkIt.disabled = true;
                    let buttonGo = document.getElementById("goButton");
                    buttonGo.disabled = true;
                    return                   
                } 
                // Clear the time taken from previous go
                document.getElementById('resultTime').innerHTML = ''
                document.getElementById('resultScore').innerHTML = '/ 10'

                // Make 'GO!'' button active and set focus to the 'GO!' button, make 'Mark it' disabled 
                let buttonMarkIt = document.getElementById("markIt");
                buttonMarkIt.disabled = true;
                let buttonGo = document.getElementById("goButton");
                buttonGo.disabled = false;
                buttonGo.focus()
            }

            function callback_goButton() {

                if (getCurrentStage() == "unselected") {
                    return                    
                } 

                // Clear any previous questions, user answers and marks from the screen
                for (let i = 0; i < 10; i++) {
                    document.getElementById(question_id[i]).innerHTML  = "";
                    document.getElementById(userAnswer_id[i]).value = "";
                    document.getElementById(mark_id[i]).style.backgroundColor = "#cccccc";
                }

                // Make 'Mark It' button active
                let buttonMarkIt = document.getElementById("markIt");
                buttonMarkIt.disabled = false;

                // Clear the time taken from previous go
                document.getElementById('resultTime').innerHTML = ''
                document.getElementById('resultScore').innerHTML = '/ 10'

                // Get the question text and answers
                let [num1_quest, symbol, num2_quest, ans] = getQuestions();
                
                // Fill up the questions 
                    for (let i = 0; i < 10; i++) {
                        // Runs 10 times and changes element id then put in a question to be shown
                        document.getElementById(question_id[i]).innerHTML = num1_quest[i] + ' ' + symbol[i] + ' ' + num2_quest[i];
                    }

                // Set focus to first answer input location
                 document.getElementById(userAnswer_id[0]).focus();

                // Start timer
                timerStart = new Date();
            }

            // Returns what stage is selected
            function getCurrentStage() {
                let currentStage = document.getElementById("dropdown-menu").value;
                return(currentStage)
            }

            function getCurrentLevel() {
                if (getCurrentStage() > 100 && getCurrentStage() < 200) {
                    currentLevel = 'bronze';
                } else if (getCurrentStage() > 200 && getCurrentStage() < 300) {
                    currentLevel = 'silver';
                } else if (getCurrentStage() > 300 && getCurrentStage() < 400) {
                    currentLevel = 'gold';
                } else if (getCurrentStage() > 400 && getCurrentStage() < 500) {
                    currentLevel = 'platinum';
                } else {
                    currentLevel = 'bronze'; // default on first loading
                }
                return(currentLevel)
            }

            function getCurrentStagesPerLevel() {
                let stagesPerLevel
                if (getCurrentLevel() == 'bronze') {
                    stagesPerLevel = levelBronzeID.length;
                } else if (getCurrentLevel() == 'silver') {
                    stagesPerLevel = levelSilverID.length;
                } else if (getCurrentLevel() == 'gold') {
                    stagesPerLevel = levelGoldID.length;
                } else if (getCurrentLevel() == 'platinum') {
                    stagesPerLevel = levelPlatinumID.length;
                }
                return(stagesPerLevel)
            }

            function getNumStages() {
                let NumStages;
                
                if (getCurrentLevel() == 'bronze') {
                    numStages = levelBronzeID.length

                }
            }

            function callback_markIt() {
                correctAnswers = 0
                // Compare the true answers to the user answers, change box to red/green as appropriate
                for (let i = 0; i < 10; i++) {
                    if (document.getElementById(userAnswer_id[i]).value == realAnswers[i]) {

                        document.getElementById(mark_id[i]).style.backgroundColor = green;
                        correctAnswers = correctAnswers + 1 
                    } else {
                        document.getElementById(mark_id[i]).style.backgroundColor = red;
                    }
                }
                
                // Find and display the time taken 
                let timerEnd = new Date();
                document.getElementById('resultTime').innerHTML = Math.round((timerEnd.getTime()-timerStart.getTime())/1000) + ' secs'
                document.getElementById('resultScore').innerHTML = correctAnswers + ' / 10'

                // Set focus to the GO! button
                // CODE THIS (not sure we need to)

            }

            // Uses current stage to get questions, question text, and answers
            function getQuestions() {

                let num1 = []; // used with num2 to work out the correct answers
                let num2 = []; // used with num1 to work out the correct answers
                let ans = []; // the correct answers
                let num1_quest = []; // the actual item to appear in the displayed question in the 'num1_quest' location. Often it is just a copy of num1, but for example a double question num1 would be '2' whilst num1_quest would be 'Double'
                let symbol = []; // the actual item to appear in the displayed question in the 'symbol' location.
                let num2_quest = []; //the actual item to appear in the displayed question in the 'num2_quest' location.
                let timesTableSelected = []; // the number (or numbers) in the times table choice seleced (e.g. [2, 4, 8] for 2s, 4s, and 8s)
                let isRandomised = 0; // If the times table stage selcted is random order (eg. bronze stage 5 is '5s mixed', so in random order)
                let questionType  //               
                let currentStage = Number(getCurrentStage()); // The currently selected stage
                let isTimesTableStage = 0;

                // The question types of each stage
                let timesTableMultiplyStages = [101, 102, 104, 105, 108, 109, 111, 112, 114, 115, 118, 119, 121, 122, 124, 125, 128, 129, 201, 202, 204, 205, 210, 213, 215, 217, 219, 221, 223, 225, 227];
                let timesTableDivideStages = [103, 106, 110, 113, 116, 120, 123, 126, 130, 203, 206, 211, 214, 216, 218, 220, 222, 224, 226, 228];
                let timesTableMultiplyAndDivideStages = [107, 117, 127, 131, 203, 207, 212];
                let multiplyStages = [229];
                let divideStages = [228];
                let multiplyAndDivideStages = [];
                let halfsStages = [];
                let doublesStages = [];
                let squaredStages = [208];
                let squareRootStages = [209];
                let cubedStages = [];
                let cubeRouteStages = [];
                let fractionsStages = [];
                let factorsStages = [];
                let modulusStages = [];
                let percentStages = [];
                let timesTableChoice = []; // The times table being tested, if more than one (e.g. 3s,6s,9s, then set to [3, 6, 9])

                let randomisedStages = [102, 103, 105, 106, 107, 109, 110, 112, 113, 115, 116, 117, 119, 120, 122, 123, 125, 126, 127,129, 130, 131, 202, 203, 205, 206, 207, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228];

                if (randomisedStages.includes(currentStage)) {
                    isRandomised = 1;
                } else {
                    isRandomised = 0;
                }

                // First get the question type, as common operations happen for a given question type.
                if (timesTableMultiplyStages.includes(currentStage)) {
                    questionType = 'timesTableMultiply';
                    isTimesTableStage = 1;
                } else if (timesTableDivideStages.includes(currentStage)) {
                    questionType = 'timesTableDivide';
                    isTimesTableStage = 1;
                } else if (timesTableMultiplyAndDivideStages.includes(currentStage)) {
                    questionType = 'timesTableMultiplyAndDivide';
                    isTimesTableStage = 1;
                } else if (multiplyStages.includes(currentStage)) {
                    questionType = 'multiply';
                } else if (divideStages.includes(currentStage)) {
                    questionType = 'divide';
                } else if (multiplyAndDivideStages.includes(currentStage)) {
                    questionType = 'multiplyAndDivide';
                } else if (halfsStages.includes(currentStage)) {
                    questionType = 'halfs';
                } else if (doublesStages.includes(currentStage)) {
                    questionType = 'doubles';
                } else if (squaredStages.includes(currentStage)) {
                    questionType = 'squared';
                } else if (squareRootStages.includes(currentStage)) {
                    questionType = 'squareRoot';
                } else if (cubedStages.includes(currentStage)) {
                    questionType = 'cubed';
                } else if (cubeRouteStages.includes(currentStage)) {
                    questionType = 'cubeRoot';
                } else if (fractionsStages.includes(currentStage)) {
                    questionType = 'fractions';
                } else if (factorsStages.includes(currentStage)) {
                    questionType = 'factors';
                } else if (modulusStages.includes(currentStage)) {
                    questionType = 'modulus';
                } else if (percentStages.includes(currentStage)) {
                    questionType = 'fractions';
                }

                if (isTimesTableStage) {
                    //The selected stage is a times table question. Get the times table being tested.
                    if ((currentStage == 101) || (currentStage ==102) || (currentStage == 103)) {
                        timesTableChoice = [10];
                    } else if ((currentStage == 104) || (currentStage == 105) || (currentStage == 106)) {
                        timesTableChoice = [5];
                    } else if  (currentStage == 107) {
                        timesTableChoice = [5, 10];
                    } else if  ((currentStage == 108) || (currentStage == 109) || (currentStage == 110)) {
                        timesTableChoice = [2];
                    } else if  ((currentStage == 111) || (currentStage == 112) || (currentStage == 113)) {
                        timesTableChoice = [4];
                    } else if  ((currentStage == 114) || (currentStage == 115) || (currentStage == 116)) {
                        timesTableChoice = [8];
                    } else if  (currentStage == 117) {
                        timesTableChoice = [2, 4 ,8]
                    } else if  ((currentStage == 118) || (currentStage == 119) || (currentStage == 120)) {
                        timesTableChoice = [3];
                    } else if  ((currentStage == 121) || (currentStage == 122) || (currentStage == 123)) {
                        timesTableChoice = [6];
                    } else if  ((currentStage == 124) || (currentStage == 125) || (currentStage == 126)) {
                        timesTableChoice = [9];
                    } else if  (currentStage == 127) {
                        timesTableChoice = [3, 6, 9];
                    } else if  ((currentStage == 128) || (currentStage == 129) || (currentStage == 130)) {
                        timesTableChoice = [7];
                    } else if  (currentStage == 131) {
                        timesTableChoice = [2, 3, 4, 5, 6, 7, 8, 9, 10]
                    } else if  ((currentStage == 201) || (currentStage == 202) || (currentStage == 203)) {
                        timesTableChoice = [11];
                    } else if  ((currentStage == 204) || (currentStage == 205) || (currentStage == 206)) {
                        timesTableChoice = [12];
                    } else if  (currentStage == 207) {
                        timesTableChoice = [11, 12];
                    } else if  ((currentStage == 210) || (currentStage == 211) || (currentStage == 212)) {
                        timesTableChoice = [2,3,4,5,6,7,8,9,10,11,12];
                    } else if  ((currentStage == 213) || (currentStage == 214)) {
                        timesTableChoice = [50];
                    } else if  ((currentStage == 215) || (currentStage == 216)) {
                        timesTableChoice = [20];
                    } else if  ((currentStage == 217) || (currentStage == 218)) {
                        timesTableChoice = [40];
                    } else if  ((currentStage == 219) || (currentStage == 220)) {
                        timesTableChoice = [80];
                    } else if  ((currentStage == 221) || (currentStage == 222)) {
                        timesTableChoice = [30];
                    } else if  ((currentStage == 223) || (currentStage == 224)) {
                        timesTableChoice = [60];
                    } else if  ((currentStage == 225) || (currentStage == 226)) {
                        timesTableChoice = [90];
                    } else if  ((currentStage == 227) || (currentStage == 228)) {
                        timesTableChoice = [70];
                    }
                }

                // For each stage work out the 1x10 array variables: num1, num2, symbol, ans, num1_quest, num2_quest              
                // Questions appear as: 'num1_quest'   'symbol'   'num2_quest'

                switch (questionType) {
                    case 'timesTableMultiply':
                        num1 = generateNumberArray(1, 10, 1); // Get an ordered list from 1 to 10 using generateNumberArray(start, end, step);
                        num2 = randomChoices(timesTableChoice, 10); //Get a random list of 10 numbers from the times tables type selected
                        if (isRandomised) {
                            num1 = randomShuffle(num1);
                        }
                        for (let i = 0; i < 10; i++) { // Runs 10 times to generate 10 questions 
                            symbol.push('\u00D7'); // '\u00D7' is the unicode 'multiply' symbol
                            ans.push(num1[i] * num2[i]);
                        }
                        num1_quest = num1;
                        num2_quest = num2;
                        break;

                    case 'timesTableDivide':
                        num1 = generateNumberArray(1, 10, 1); // Get an ordered list from 1 to 10 using generateNumberArray(start, end, step);
                        num2 = randomChoices(timesTableChoice, 10); //Get a random list of 10 numbers from the times tables type selected
                        if (isRandomised) {
                            num1 = randomShuffle(num1);
                        }
                        for (let i = 0; i < 10; i++) { // Runs 10 times to generate 10 questions 
                            symbol.push('\u00F7'); // '\u00F7' is the unicode 'divide' symbol
                            ans.push(num1[i] * num2[i]);
                        }
                        // currenlty coded as a multiply question, so need to switch the numbers over 
                        let tempAns = ans;
                        ans = num1;
                        num1 = tempAns;
                        num1_quest = num1;
                        num2_quest = num2;
                        break;


                    case 'timesTableMultiplyAndDivide':
                        let isDivide = randomChoices([0, 1], 10); // get an array of 0s and 1s defining if the question will be a divide or a multiply question
                        num1 = generateNumberArray(1, 10, 1); // Get an ordered list from 1 to 10 using generateNumberArray(start, end, step);
                        num2 = randomChoices(timesTableChoice, 10); //Get a random list of 10 numbers from the times tables type selected
                        
                        if (isRandomised) {
                            num1 = randomShuffle(num1);
                        }   
                        for (let i = 0; i < 10; i++) { // Runs 10 times to generate 10 questions 
                            ans.push(num1[i] * num2[i]);
                            if (isDivide[i]) {
                                let tempAns = ans[i];
                                ans[i] = num1[i];
                                num1[i] = tempAns;
                                symbol.push('\u00F7'); // '\u00F7' is the unicode 'divide' symbol
                            } else {
                                symbol.push('\u00D7'); // '\u00D7' is the unicode 'multiply' symbol
                            }
                        }        
                        num1_quest = num1;
                        num2_quest = num2;
                        break;

                    // case TODO: CODE FOR STAGE 208 (square numbers)

                    // case TODO: CODE FOR STAGE 209 (square roots)

                    // case TODO: CODE FOR STAGE 229 (2 and 3 digit x 10 & 100)

                    // case TODO: CODE FOR STAGE 230 (2 and 3 digit / 10 & 100)

                    }

                realAnswers = ans;
                return([num1_quest, symbol, num2_quest, ans]); 
            }


            //function for generating an array of numbers with a 'start' 'end' and 'step'
            function generateNumberArray(start, end, step) {
                let array = [];
                //(let i = 0; i < k; i++){
                for (let i = 1; i <= end; i=i+step) {
                    array.push(i);
                }
                return array
            }

            //function to perform a random shuffle of an array. See https://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle
            function randomShuffle(array) {
                let currentIndex = array.length,  randomIndex;

                // While there remain elements to shuffle.
                while (currentIndex != 0) {

                    // Pick a remaining element.
                    randomIndex = Math.floor(Math.random() * currentIndex);
                    currentIndex--;

                    // And swap it with the current element.
                    [array[currentIndex], array[randomIndex]] = [
                    array[randomIndex], array[currentIndex]];
                }
                return array
            }

            // funtion to pick a random sample of k items from an array, item is not repeated
            function randomSample(array, k) {
                let newArray = [];
                let currentIndex = array.length, randomIndex;
               
                // While there remain elements to be picked.
                while (currentIndex != array.length - k) {

                    // Pick a remaining element.
                    randomIndex = Math.floor(Math.random() * currentIndex);
                    currentIndex--;

                    // And swap it with the current element so it wont get picked again.
                    [array[currentIndex], array[randomIndex]] = [
                    array[randomIndex], array[currentIndex]];
                }
                // Get the randomly picked elements stored at the end of the array
                newArray = array.slice(array.length - k)

                return newArray

            }

            // funtion to pick a random sample of k items from an array, item can be repeated
            function randomChoices(array, k) {
                let newArray = [];

                for (let i = 0; i < k; i++){
                    randomIndex = Math.floor(Math.random() * array.length)
                    newArray.push(array[randomIndex])
                }

                return newArray
            }

            function doesQuestExist(num1ToTest, symbolToTest, num2ToTest, num1, symbol, num2) {
            // TODO: Code this, currently in Python format
            // Searches for common num1, symbol and num2 locations and returns the number of matches found.
            // num1ToTest, symbolToTest and num2ToTest define the question to look for. 
            // num1, symbol and num2 are lists defining the questions already in existance (those to search through).
            // Returns the number of matches found.  If no matches, returns 0.

                // num1RepeatsBool = [1 if num1ToTest==num1[i] else 0 for i in range(len(num1))]
                // symbolRepeatsBool = [1 if symbolToTest==symbol[i] else 0 for i in range(len(num1))]
                // num2RepeatsBool = [1 if num2ToTest==num2[i] else 0 for i in range(len(num1))]

                // matches = [num1RepeatsBool[i]*num2RepeatsBool[i]*symbolRepeatsBool[i] for i in range(len(num1RepeatsBool))]
                // matchCount = sum(matches)
 
                // return matchCount
            }





        </script>
    </head>
    

    <body style="padding-top: 0%;" id="body">

        <style>
            body {
                overflow-x: hidden; /* Hide horizontal scrollbar */
            }
        </style>

        <div class="container">
            <!--Title-->
            <div class="row d-flex justify-content-center" style="padding-bottom: 1%; padding-top: 1%">
                <h1 class="white">Maths Challenge</h1>
            </div>
            <!-- Stage Headings -->
            <div class="row d-flex container justify-content-center" style="width: auto;">
                <!-- Bronze #CD7F32
                // Silver #C0C0C0
                // Gold #D4AF37
                // Platinum  #E5E4E2 -->
                <button class="btn btn-primary" type="submit" id="buttonBronze" tabindex="0" style="margin-left: .5%; min-width: 85px; background-color: #CD7F32; border: #CD7F32;">Bronze</button>
                <button class="btn btn-primary" type="submit" id="buttonSilver" tabindex="0" style="margin-left: .5%; min-width: 85px; background-color: #C0C0C0; border: #C0C0C0;">Silver</button>
                <button class="btn btn-primary" type="submit" id="buttonGold" tabindex="0" style="margin-left: .5%; min-width: 85px; background-color: #D4AF37; border: #D4AF37;">Gold</button>
                <button class="btn btn-primary" type="submit" id="buttonPlatinum" tabindex="0" style="margin-left: .5%; min-width: 85px; background-color: #E5E4E2; border: #E5E4E2;">Platinum</button>
            </div>
            <!--Dropdown--> <!--Go button-->
            <div class="row" style="padding-bottom: 2%; padding-top: 2%;">
                <div class="dropdown container d-flex justify-content-center">
                    <select id="dropdown-menu" onchange="callback_changeStage()" style="text-align-last: center; color: white; background-color: #0275d8; min-width: 200px; min-height: 35px; max-height: 35px;">
                        <option value="unselected" style="text-align-last: center;">Select Stage</option>
                        <option value="101" style="text-align-last: center;">1.    10s in Order</option>
                        <option value="102" style="text-align-last: center;">2.    10s mixed</option>
                        <option value="103" style="text-align-last: center;">3.    10s division mixed</option>
                        <option value="104" style="text-align-last: center;">4.    5s in Order</option>
                        <option value="105" style="text-align-last: center;">5.    5s mixed</option>
                        <option value="106" style="text-align-last: center;">6.    5s division mixed</option>
                        <option value="107" style="text-align-last: center;">7.    10s and 5s mixed</option>
                        <option value="108" style="text-align-last: center;">8.    2s in order</option>
                        <option value="109" style="text-align-last: center;">9.    2s mixed</option>
                        <option value="110" style="text-align-last: center;">10.   2s division mixed</option>
                        <option value="111" style="text-align-last: center;">11.   4s in order</option>
                        <option value="112" style="text-align-last: center;">12.   4s mixed</option>
                        <option value="113" style="text-align-last: center;">13.   4s division mixed</option>
                        <option value="114" style="text-align-last: center;">14.   8s in order</option>
                        <option value="115" style="text-align-last: center;">15.   8s mixed</option>
                        <option value="116" style="text-align-last: center;">16.   8s division mixed</option>
                        <option value="117" style="text-align-last: center;">17.   2, 4, 8s mixed</option>
                        <option value="118" style="text-align-last: center;">18.   3s in order</option>
                        <option value="119" style="text-align-last: center;">19.   3s mixed</option>
                        <option value="120" style="text-align-last: center;">20.   3s division mixed</option>
                        <option value="121" style="text-align-last: center;">21.   6s in order</option>
                        <option value="122" style="text-align-last: center;">22.   6s mixed</option>
                        <option value="123" style="text-align-last: center;">23.   6s division mixed</option>
                        <option value="124" style="text-align-last: center;">24.   9s in order</option>
                        <option value="125" style="text-align-last: center;">25.   9s mixed</option>
                        <option value="126" style="text-align-last: center;">26.   9s division mixed</option>
                        <option value="127" style="text-align-last: center;">27.   3, 6, 9s mixed</option>
                        <option value="128" style="text-align-last: center;">28.   7s in order</option>
                        <option value="129" style="text-align-last: center;">29.   7s mixed</option>
                        <option value="130" style="text-align-last: center;">30.   7s division mixed</option>
                        <option value="131" style="text-align-last: center;">31.   2s - 10s mixed</option>
                        
                    </select>
                    <button class="btn btn-primary" type="submit" id="goButton" style="margin-left: 3%;">Go!</button>
                </div>
            </div>
            <!--Table for challenge-->
            <div class="row d-flex justify-content-center">
                <table class="table w-25" style="transform: translate(-50%,0); position: absolute; left: 50%;">
                    <thead>
                        <tr>
                            <th scope="col" style="width: 15%"></th>
                            <th scope="col" style="width: 30%">Question</th>
                            <th scope="col" style="width: 25%">Your Answer</th>
                            <th scope="col" style="width: 25%">Marks</th>
                        </tr>
                        </thead>
                        <tbody>
    
                        <!--Row one-->
                        <tr>
                            <th scope="row" class="table-element">1</th>
                            <td id="q1" class="table-element"></td>
                            <td>
                                <input type="tel" class=" table-element form-control" id="inputAnswer1" tabindex="0">
                            </td>
                            <td>
                                <fieldset disabled>
                                    <div>
                                        <input class="table-element form-control" id ="mark1" style="background-color: #cccccc;">
                                    </div>
                                </fieldset>
                            </td>
                        </tr>
                
                        <!--Row two-->
                        <tr>
                            <th scope="row">2</th>
                            <td id="q2"></td>
                            <td>
                                <input type="tel" class="form-control" id="inputAnswer2" tabindex="0">
                            </td>
                            <td>
                                <fieldset disabled>
                                    <div>
                                        <!--style="background-color: #cccccc;"-->
                                        <input class="form-control" id ="mark2" style="background-color: #cccccc;">
                                    </div>
                                </fieldset>
                            </td>
                        </tr>
    
                        <!--Row three-->
                        <tr>
                            <th scope="row">3</th>
                            <td id="q3"></td>
                            <td>
                                <input type="tel" class="form-control" id="inputAnswer3" tabindex="0">
                            </td>
                            <td>
                                <fieldset disabled>
                                    <div>
                                        <input class="form-control" id="mark3" style="background-color: #cccccc;">
                                    </div>
                                </fieldset>
                            </td>
                        </tr>
                        <!--Row four-->
                        <tr>
                            <th scope="row">4</th>
                            <td id="q4"></td>
                            <td>
                                <input type="tel" class="form-control" id="inputAnswer4" tabindex="0">
                            </td>
                            <td>
                                <fieldset disabled>
                                    <div>
                                        <input class="form-control" id ="mark4" style="background-color: #cccccc;">
                                    </div>
                                </fieldset>
                            </td>
                        </tr>
    
                        <!-- TAB-Index: https://developer.mozilla.org/en-US/docs/Web/HTML/Global_attributes/tabindex-->
                      
                        <!--Row five-->
                        <tr>
                            <th scope="row">5</th>
                            <td id="q5"></td>
                            <td>
                                <input type="tel" class="form-control" id="inputAnswer5" tabindex="0">
                            </td>
                            <td>
                                <fieldset disabled>
                                    <div>
                                        <input class="form-control" id ="mark5" style="background-color: #cccccc;">
                                    </div>
                                </fieldset>
                            </td>
                        </tr>
    
                        <!--Row six-->
                        <tr>
                            <th scope="row">6</th>
                            <td id="q6"></td>
                            <td>
                                <input type="tel" class="form-control" id="inputAnswer6" tabindex="0">
                            </td>
                            <td>
                                <fieldset disabled>
                                    <div>
                                        <input class="form-control" id="mark6" style="background-color: #cccccc;">
                                    </div>
                                </fieldset>
                            </td>
                        </tr>
                        <!--Row seven-->
                        <tr>
                            <th scope="row">7</th>
                            <td id="q7"></td>
                            <td>
                                <input type="tel" class="form-control" id="inputAnswer7" tabindex="0">
                            </td>
                            <td>
                                <fieldset disabled>
                                    <div>
                                        <input class="form-control" id ="mark7" style="background-color: #cccccc;">
                                    </div>
                                </fieldset>
                            </td>
                        </tr>
    
                        <!--Row eight-->
                        <tr>
                            <th scope="row">8</th>
                            <td id="q8"></td>
                            <td>
                                <input type="tel" class="form-control" id="inputAnswer8" tabindex="0">
                            </td>
                            <td>
                                <fieldset disabled>
                                    <div>
                                        <input class="form-control" id="mark8" style="background-color: #cccccc;">
                                    </div>
                                </fieldset>
                            </td>
                        </tr>
                        <!--Row nine-->
                        <tr>
                            <th scope="row">9</th>
                            <td id="q9"></td>
                            <td>
                                <input type="tel" class="form-control" id="inputAnswer9" tabindex="0">
                            </td>
                            <td>
                                <fieldset disabled>
                                    <div>
                                        <input class="form-control" id ="mark9" style="background-color: #cccccc;">
                                    </div>
                                </fieldset>
                            </td>
                        </tr>
    
                        
                        <!--Row ten-->
                        <tr>
                            <th scope="row">10</th>
                            <td id="q10"></td>
                            <td>
                                <input type="tel" class="form-control" id="inputAnswer10" tabindex="0">
                            </td>
                            <td>
                                <fieldset disabled>
                                    <div>
                                        <input class="form-control" id ="mark10" style="background-color: #cccccc;">
                                    </div>
                                </fieldset>
                            </td>
                        </tr>
    
                        <!--Results-->
                        <tr>
                            <th scope="row"></th>
                            <td><p id="resultTime"></p></td>
                            <td></td>
                            <td>
                                <p id="resultScore">/ 10</p>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </table>
            </div>
            <div id="spacer" style="width: 200px; height: 620px; margin-right:0px;"></div>
            <div class="row">
                <!--Mark it button-->
                <div class="container-fluid d-flex justify-content-center">
                    <button class="btn btn-primary" type="submit" id="markIt" tabindex="0">Mark Answers</button>
                </div>
            </div>
        </div>

        


        
        <!--JavaScript Links-->
        <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

    </body>

    <footer>

    </footer>
</html>